<div class="dashboard-container">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="navbar-content">
      <div class="logo">
        <h1>ğŸ“‹ DMS</h1>
      </div>
      <div class="nav-actions">
        <span class="username" *ngIf="currentUser">{{ currentUser.username }}</span>
        <a routerLink="/upload" class="btn btn-primary btn-sm">Upload</a>
        <button (click)="logout()" class="btn btn-secondary btn-sm">Logout</button>
      </div>
    </div>
  </nav>

  <div class="main-content">
    <!-- Search and Filters -->
    <div class="search-section">
      <div class="search-bar">
        <input type="text" [(ngModel)]="searchQuery" (keyup.enter)="onSearch()"
          placeholder="Search documents by title or description..." class="search-input" />
        <button (click)="onSearch()" class="btn btn-primary">Search</button>
      </div>

      <!-- Filters -->
      <div *ngIf="categories.length > 0 || allTags.length > 0" class="filters">
        <button *ngIf="searchQuery || selectedCategory || selectedTag" (click)="clearFilters()"
          class="btn btn-secondary btn-sm">
          Clear Filters
        </button>

        <div *ngIf="categories.length > 0" class="filter-group">
          <span class="filter-label">Categories:</span>
          <button *ngFor="let cat of categories" (click)="filterByCategory(cat)"
            [class.active]="selectedCategory === cat" class="filter-chip">
            {{ cat }}
          </button>
        </div>

        <div *ngIf="allTags.length > 0" class="filter-group">
          <span class="filter-label">Tags:</span>
          <button *ngFor="let tag of allTags" (click)="filterByTag(tag)" [class.active]="selectedTag === tag"
            class="filter-chip">
            {{ tag }}
          </button>
        </div>
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="alert alert-error">
      {{ error }}
    </div>

    <!-- Documents Grid -->
    <div *ngIf="loading" class="loading-state">
      <div class="spinner"></div>
      <p>Loading documents...</p>
    </div>

    <div *ngIf="!loading && documents.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ“­</div>
      <h2>No documents found</h2>
      <p>Start by uploading a document or adjust your filters</p>
      <a routerLink="/upload" class="btn btn-primary">Upload First Document</a>
    </div>

    <div *ngIf="!loading && documents.length > 0" class="documents-grid">
      <div *ngFor="let doc of documents" class="document-card">
        <div class="card-header">
          <span class="file-icon">{{ getFileIcon(doc.mimeType) }}</span>
          <div class="card-actions">
            <button *ngIf="isOwner(doc.uploadedBy._id)" (click)="deleteDocument(doc._id, $event)" class="btn-icon"
              title="Delete">
              ğŸ—‘ï¸
            </button>
          </div>
        </div>

        <div class="card-content">
          <h3 class="doc-title">{{ doc.title }}</h3>
          <p class="doc-description">{{ doc.description || 'No description' }}</p>

          <div class="doc-meta">
            <span class="meta-item">ğŸ“¦ {{ formatFileSize(doc.fileSize) }}</span>
            <span class="meta-item">v{{ doc.currentVersion }}</span>
            <span class="meta-item">ğŸ“… {{ formatDate(doc.createdAt) }}</span>
          </div>

          <div *ngIf="doc.tags.length > 0" class="tags">
            <span *ngFor="let tag of doc.tags" class="tag">{{ tag }}</span>
          </div>

          <div class="category-badge">{{ doc.category }}</div>
        </div>

        <div class="card-footer">
          <button (click)="downloadDocument(doc._id, doc.title, $event)" class="btn btn-secondary btn-sm">
            Download
          </button>
          <button *ngIf="isOwner(doc.uploadedBy._id)" class="btn btn-secondary btn-sm"
            [routerLink]="['/update', doc._id]">
            Update
          </button>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="!loading && totalPages > 1" class="pagination">
      <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1" class="btn btn-secondary btn-sm">
        Previous
      </button>

      <div class="page-info">
        Page {{ currentPage }} of {{ totalPages }} ({{ totalDocuments }} documents)
      </div>

      <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages"
        class="btn btn-secondary btn-sm">
        Next
      </button>
    </div>
  </div>
</div>